
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üíå Th√†nh t·ªè t√¨nh v·ªõi Nh√£ üíñ</title>
    <!-- T·∫£i Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- T·∫£i Font Poppins (thay th·∫ø SF Pro Rounded) -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- T·∫£i Tone.js cho hi·ªáu ·ª©ng √¢m thanh nh·∫π nh√†ng -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        /* C·∫•u h√¨nh chung v√† font */
        :root {
            --pink-light: #FFC0CB;
            --pink-medium: #FF8F9C;
            --purple-light: #C3B1E1;
            --white-trans: rgba(255, 255, 255, 0.75);
            --blur-intensity: 15px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden; /* NgƒÉn cu·ªôn khi c√≥ hi·ªáu ·ª©ng tim bay/confetti */
            -webkit-tap-highlight-color: transparent; /* TƒÉng tr·∫£i nghi·ªám mobile */
        }

        /* --- 1. Hi·ªáu ·ª©ng Gradient N·ªÅn ƒê·ªông (Phase 1) --- */
        .gradient-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(-45deg, var(--pink-light), var(--purple-light), #F5B9D9, #A990F0);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- 2. Hi·ªáu ·ª©ng Tim Bay (Floating Hearts) --- */
        @keyframes float-up {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100vh) scale(1.5); opacity: 0; }
        }

        .heart {
            position: absolute;
            color: var(--pink-medium);
            font-size: 1.5rem;
            animation: float-up linear infinite;
            pointer-events: none;
            text-shadow: 0 0 5px rgba(255, 143, 156, 0.5);
        }

        /* --- 3. Hi·ªáu ·ª©ng ƒê√°nh m√°y (Typing Animation) --- */
        .typing-container {
            display: inline-block;
            overflow: hidden;
            border-right: .15em solid white; /* Con tr·ªè nh·∫•p nh√°y */
            white-space: nowrap;
            letter-spacing: .05em;
            animation: blink-caret 0.75s step-end infinite;
        }

        .typing-static {
            border-right: none;
            animation: none;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: white }
        }

        /* --- 4. Hi·ªáu ·ª©ng N√∫t Gentle Slide Up & Fade-in (ch·∫≠m r√£i, t·ª± nhi√™n) --- */
        @keyframes slide-up-gentle {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .slide-up-gentle-in {
            /* T·ªëc ƒë·ªô n√∫t: 0.8s */
            animation: slide-up-gentle 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) both; 
        }

        /* --- 5. Hi·ªáu ·ª©ng Th·∫ª iOS (Backdrop Blur) --- */
        .ios-card {
            background-color: var(--white-trans);
            backdrop-filter: blur(var(--blur-intensity));
            -webkit-backdrop-filter: blur(var(--blur-intensity));
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            transition: all 0.4s ease;
        }

        /* --- 6. Hi·ªáu ·ª©ng ƒê·∫≠p Tim L·ªõn (Pulsing Heart) --- */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .pulsing-heart {
            animation: pulse 1.5s infinite;
        }

        /* --- 7. Hi·ªáu ·ª©ng Popup iOS (Zoom In) --- */
        @keyframes zoom-in {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .zoom-in {
            animation: zoom-in 0.3s ease-out forwards;
        }

        /* --- 8. Confetti (ch·ªâ CSS/DOM) --- */
        .confetti {
            position: fixed;
            z-index: 1000;
            pointer-events: none;
            width: 10px;
            height: 10px;
            opacity: 0;
            border-radius: 50%;
            transition: none;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0.5; }
        }

    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center text-white text-center p-4">

    <!-- N·ªÅn Gradient ƒê·ªông -->
    <div id="background" class="gradient-background transition-all duration-1000 ease-in-out"></div>

    <!-- Container cho c√°c tr√°i tim bay -->
    <div id="heart-container" class="absolute w-full h-full overflow-hidden top-0 left-0"></div>

    <!-- Container Ch√≠nh -->
    <div id="main-content" class="relative z-10 w-full max-w-sm md:max-w-md">

        <!-- Phase 1: M·ªü ƒë·∫ßu -->
        <div id="intro-phase" class="space-y-6">
            <h1 id="typing-text" class="text-4xl md:text-5xl font-extrabold tracking-tight text-shadow-lg drop-shadow-lg h-14 md:h-20">
                <!-- Ch·ªØ s·∫Ω ƒë∆∞·ª£c th√™m v√†o b·∫±ng JS -->
            </h1>
            <p id="sub-text" class="text-xl md:text-2xl font-medium opacity-0 transition-opacity duration-700 ease-in mt-4">
                Anh c√≥ ƒëi·ªÅu n√†y mu·ªën n√≥i v·ªõi pe iu n√®‚Ä¶
            </p>
            <button id="start-button" onclick="startConfession()"
                class="hidden w-full max-w-xs mx-auto py-3 px-6 bg-white text-pink-medium rounded-full shadow-xl font-bold text-lg hover:shadow-2xl active:scale-95 transition-transform duration-200 focus:outline-none"
                style="color: var(--pink-medium);"
            >
                Nh·∫•n ƒë·ªÉ xem ƒëi·ªÅu anh mu·ªën n√≥i nhooü•∞
            </button>
        </div>

        <!-- Phase 2: Th·∫ª T·ªè t√¨nh Ch√≠nh -->
        <div id="confession-phase" class="hidden ios-card text-gray-800 space-y-4 md:space-y-6 transform translate-y-10 opacity-0">
            <h2 id="line-1" class="text-3xl font-bold text-pink-medium text-left opacity-0 transition-opacity duration-700">Nh√£ √†‚Ä¶</h2>
            <p id="line-2" class="text-lg md:text-xl font-medium text-left opacity-0 transition-opacity duration-700 delay-300">T·ª´ l·∫ßn ƒë·∫ßu g·∫∑p c·∫≠u, Anh th·∫•y tim m√¨nh rung l√™n th·∫≠t l·∫° üíì</p>
            <p id="line-3" class="text-lg md:text-xl font-medium text-left opacity-0 transition-opacity duration-700 delay-700">Anh kh√¥ng bi·∫øt n√≥i sao cho hay‚Ä¶</p>
            <p id="line-4" class="text-2xl md:text-3xl font-extrabold text-left opacity-0 transition-opacity duration-700 delay-1000 mt-6">Nh∆∞ng Anh bi·∫øt m·ªôt ƒëi·ªÅu ‚Äî Anh r·∫•t th√≠ch em ü•∫‚ù§Ô∏è</p>

            <!-- Tim L·ªõn -->
            <div id="large-heart" class="text-6xl pulsing-heart mt-8 hidden transition-opacity duration-500">
                <span style="color: var(--pink-medium);">üíñ</span>
            </div>

            <!-- Phase 3: N√∫t Cao tr√†o -->
            <button id="accept-button" onclick="showClimax()"
                class="hidden w-full mt-8 py-3 px-6 bg-pink-medium text-white rounded-xl shadow-xl font-bold text-lg hover:bg-pink-medium/90 active:scale-95 transition-transform duration-200 focus:outline-none"
                style="background-color: var(--pink-medium);"
            >
               ·∫§n v√†o n·∫øu em c≈©ng th√≠ch anh ^^
            </button>
        </div>

        <!-- Popup Climax (C√≥ th√™m ph·∫ßn ch·ª•p m√†n h√¨nh) -->
        <div id="climax-popup" class="fixed inset-0 flex items-center justify-center bg-black/20 z-20 hidden">
            <div id="climax-card" class="ios-card zoom-in p-6 md:p-8 text-gray-800 shadow-2xl max-w-xs md:max-w-sm mx-auto text-center" style="transform: scale(0.5); opacity: 0;">
                <p class="text-2xl md:text-3xl font-extrabold text-pink-medium">
                    Thi·ªác h·ªè ü•π
                </p>
                <p class="text-xl md:text-2xl font-medium mt-2">
                    Anh h·∫°nh ph√∫c l·∫Øm lu√¥n ƒë√≥! üíûüí´
                </p>

                <!-- L·ªùi nh·∫Øc ch·ª•p m√†n h√¨nh -->
                <div id="screenshot-prompt" class="mt-6 pt-4 border-t border-pink-light/50 opacity-0 transition-opacity duration-700">
                    <p class="text-base font-semibold text-gray-600 mb-1 flex items-center justify-center">
                        <span class="mr-2 text-xl"></span> Ch·ª•p m√†n h√¨nh kho·∫£nh kh·∫Øc n√†y g·ª≠i cho anh nhoo!
                    </p>
                    <p class="text-xs text-gray-500 mt-1">
                    </p>
                </div>
            </div>
        </div>

    </div>

    <!-- JavaScript & Logic -->
    <script>
        // --- C·∫•u h√¨nh Firebase ƒë·ªÉ tu√¢n th·ªß quy t·∫Øc, m·∫∑c d√π kh√¥ng d√πng Firestore ---
        // Bi·∫øn to√†n c·ª•c t·ª´ m√¥i tr∆∞·ªùng Canvas (KH√îNG THAY ƒê·ªîI)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // --- Tone.js Setup for sweet sound ---
        const synth = new Tone.Synth({
            oscillator: { type: "sine" },
            envelope: {
                attack: 0.01,
                decay: 0.2,
                sustain: 0.0,
                release: 0.3
            }
        }).toDestination();

        function playSweetChord() {
            // ƒê·∫£m b·∫£o Tone.js ƒë∆∞·ª£c kh·ªüi ƒë·ªông tr√™n tr√¨nh duy·ªát di ƒë·ªông
            if (Tone.context.state !== 'running') {
                Tone.start();
            }
            const now = Tone.now();
            // Ch∆°i m·ªôt h·ª£p √¢m tr∆∞·ªüng nh·∫π nh√†ng
            synth.triggerAttackRelease('C5', '4n', now);
            synth.triggerAttackRelease('E5', '4n', now + 0.05);
            synth.triggerAttackRelease('G5', '4n', now + 0.1);
        }

        // --- Khai b√°o bi·∫øn DOM ---
        const typingTextEl = document.getElementById('typing-text');
        const subTextEl = document.getElementById('sub-text');
        const startButton = document.getElementById('start-button');
        const confessionPhase = document.getElementById('confession-phase');
        const acceptButton = document.getElementById('accept-button');
        const climaxPopup = document.getElementById('climax-popup');
        const climaxCard = document.getElementById('climax-card');
        const screenshotPrompt = document.getElementById('screenshot-prompt');
        const background = document.getElementById('background');
        const largeHeart = document.getElementById('large-heart');

        // --- H√†m t·∫°o hi·ªáu ·ª©ng tim bay ---
        function createFloatingHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = ['üíñ', 'üíï', 'üíì', 'üíó'][Math.floor(Math.random() * 4)];
            
            const size = Math.random() * 1.5 + 1; // 1rem to 2.5rem
            const startX = Math.random() * window.innerWidth;
            const duration = Math.random() * 10 + 5; // 5s to 15s

            heart.style.left = `${startX}px`;
            heart.style.fontSize = `${size}rem`;
            heart.style.opacity = Math.random() * 0.5 + 0.5;
            heart.style.animationDuration = `${duration}s`;
            heart.style.animationDelay = `-${Math.random() * duration}s`; // Ng·∫´u nhi√™n h√≥a ƒëi·ªÉm b·∫Øt ƒë·∫ßu
            
            document.getElementById('heart-container').appendChild(heart);
            
            // X√≥a tim sau khi animation k·∫øt th√∫c
            setTimeout(() => heart.remove(), duration * 1000);
        }

        // T·∫°o li√™n t·ª•c c√°c tr√°i tim
        let heartInterval;
        function startHeartAnimation() {
            if (!heartInterval) {
                for (let i = 0; i < 20; i++) { // B·∫Øt ƒë·∫ßu v·ªõi m·ªôt lo·∫°t tim
                    createFloatingHeart();
                }
                heartInterval = setInterval(createFloatingHeart, 500); // Th√™m tim m·ªõi m·ªói 0.5s
            }
        }

        // --- H√†m hi·ªáu ·ª©ng ƒê√°nh m√°y (Typing Animation) ---
        function typeWriter(text, element, callback) {
            let i = 0;
            element.classList.remove('typing-static'); // Th√™m hi·ªáu ·ª©ng con tr·ªè nh·∫•p nh√°y
            
            function typing() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    // *** ƒê√É ƒêI·ªÄU CH·ªàNH: TƒÉng ƒë·ªô tr·ªÖ l√™n 200ms cho hi·ªáu ·ª©ng "ch·∫≠m th·∫≠t ch·∫≠m" ***
                    setTimeout(typing, 200); 
                } else {
                    element.classList.add('typing-static'); // D·ª´ng con tr·ªè
                    if (callback) {
                        setTimeout(callback, 500);
                    }
                }
            }
            typing();
        }

        // --- PHASES LOGIC ---

        // Phase 1: B·∫Øt ƒë·∫ßu
        function startIntro() {
            startHeartAnimation();
            const textToType = "Hi Nh√£ üíñ";
            typeWriter(textToType, typingTextEl, () => {
                subTextEl.classList.remove('opacity-0');
                subTextEl.classList.add('opacity-100', 'transition-opacity', 'duration-700');
                
                // Hi·ªÉn th·ªã n√∫t sau khi subText hi·ªán ra
                setTimeout(() => {
                    startButton.classList.remove('hidden');
                    // √Åp d·ª•ng hi·ªáu ·ª©ng slide-up-gentle-in m·ªõi
                    startButton.classList.add('slide-up-gentle-in'); 
                }, 700);
            });
        }

        // Phase 2: T·ªè t√¨nh
        function startConfession() {
            startButton.style.display = 'none';
            document.getElementById('intro-phase').style.display = 'none';
            
            // ƒê·ªïi n·ªÅn gradient r·ª±c r·ª° h∆°n
            background.style.background = 'linear-gradient(-45deg, #FF69B4, #E6E6FA, #FFB6C1, #8A2BE2)';
            background.style.backgroundSize = '400% 400%';
            
            confessionPhase.classList.remove('hidden');
            
            // Hi·ªáu ·ª©ng Slide-Up & Fade-in cho card
            setTimeout(() => {
                confessionPhase.classList.remove('translate-y-10', 'opacity-0');
                confessionPhase.classList.add('translate-y-0', 'opacity-100');
                
                // Hi·ªÉn th·ªã l·∫ßn l∆∞·ª£t c√°c d√≤ng
                const lines = [
                    document.getElementById('line-1'),
                    document.getElementById('line-2'),
                    document.getElementById('line-3'),
                    document.getElementById('line-4')
                ];
                
                lines.forEach((line, index) => {
                    // C√†i ƒë·∫∑t ƒë·ªô tr·ªÖ ƒë·ªÉ c√°c d√≤ng hi·ªán l·∫ßn l∆∞·ª£t
                    setTimeout(() => {
                        line.classList.remove('opacity-0');
                    }, index * 1200 + 400); 
                });

                // Hi·ªÉn th·ªã tim l·ªõn v√† n√∫t ch·∫•p nh·∫≠n sau khi c√°c d√≤ng ƒë√£ hi·ªán
                setTimeout(() => {
                    largeHeart.classList.remove('hidden');
                    largeHeart.classList.add('opacity-100');
                    
                    acceptButton.classList.remove('hidden');
                    // √Åp d·ª•ng hi·ªáu ·ª©ng slide-up-gentle-in m·ªõi
                    acceptButton.classList.add('slide-up-gentle-in'); 
                }, 4 * 1200 + 1000); // Ch·ªù 4 d√≤ng + 1s
            }, 50);
        }

        // Phase 3: Cao tr√†o (Ch·∫•p nh·∫≠n)
        function showClimax() {
            playSweetChord(); // Ch∆°i √¢m thanh vui v·∫ª
            
            acceptButton.style.display = 'none';
            confessionPhase.style.pointerEvents = 'none'; // NgƒÉn t∆∞∆°ng t√°c v·ªõi card
            
            climaxPopup.classList.remove('hidden');
            
            // Hi·ªáu ·ª©ng Zoom In
            setTimeout(() => {
                climaxCard.style.transform = 'scale(1)';
                climaxCard.style.opacity = '1';
                createConfetti(100); // T·∫°o 100 h·∫°t confetti
                
                // Hi·ªán prompt ch·ª•p m√†n h√¨nh sau khi popup hi·ªán ra
                setTimeout(() => {
                    screenshotPrompt.classList.remove('opacity-0');
                }, 500); // Ch·ªù 0.5s sau khi popup hi·ªán ra
            }, 50);
        }

        // --- H√†m t·∫°o Confetti (DOM/CSS Lightweight) ---
        function createConfetti(num) {
            const colors = ['#FFC0CB', '#FF69B4', '#E6E6FA', '#C3B1E1', '#FFFFFF'];
            const container = document.body;
            
            for (let i = 0; i < num; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                
                const size = Math.random() * 8 + 5; // K√≠ch th∆∞·ªõc 5px - 13px
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.top = `${Math.random() * 10 - 20}vh`; // B·∫Øt ƒë·∫ßu t·ª´ tr√™n c√πng
                
                const duration = Math.random() * 3 + 2; // 2s - 5s
                confetti.style.animation = `confetti-fall ${duration}s ease-in forwards`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                
                container.appendChild(confetti);

                // D·ªçn d·∫πp DOM
                setTimeout(() => confetti.remove(), duration * 1000 + 500);
            }
        }

        // Kh·ªüi ch·∫°y intro khi trang t·∫£i xong
        window.onload = startIntro;

    </script>
</body>
</html>

